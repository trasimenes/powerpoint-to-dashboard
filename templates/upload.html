{% extends 'base.html' %}
{% block title %}Upload PowerPoint{% endblock %}
{% block content %}
<!-- Statistiques -->
{% if stats and stats.total_extractions > 0 %}
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header bg-light">
        <h5 class="card-title mb-0">
          <i class="bi bi-graph-up me-2"></i>Statistiques de l'application
        </h5>
      </div>
      <div class="card-body">
        <div class="row text-center">
          <div class="col-md-3">
            <div class="border-end">
              <h3 class="text-primary">{{ stats.total_extractions }}</h3>
              <p class="text-muted mb-0">Analyses totales</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="border-end">
              <h3 class="text-success">{{ stats.successful_extractions }}</h3>
              <p class="text-muted mb-0">Analyses réussies</p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="border-end">
              <h3 class="text-warning">{{ stats.failed_extractions }}</h3>
              <p class="text-muted mb-0">Analyses échouées</p>
            </div>
          </div>
          <div class="col-md-3">
            <div>
              <h3 class="text-info">
                {% if stats.last_extraction %}
                  <small>{{ stats.last_extraction.split(' ')[0] }}</small>
                {% else %}
                  -
                {% endif %}
              </h3>
              <p class="text-muted mb-0">Dernière analyse</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endif %}

<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card">
      <div class="card-header bg-primary text-white">
        <h3 class="card-title mb-0">
          <i class="bi bi-upload me-2"></i>Upload PowerPoint
        </h3>
      </div>
      <div class="card-body">
        <div class="alert alert-info">
          <i class="bi bi-info-circle me-2"></i>
          <strong>Instructions :</strong> Uploadez votre fichier PowerPoint (.pptx) pour extraire les données des slides 31 et 32 par défaut.
        </div>
        
        <form method="post" enctype="multipart/form-data">
          <div class="mb-4">
            <label for="pptx" class="form-label fw-bold">
              <i class="bi bi-file-earmark-ppt me-1"></i>Fichier PowerPoint
            </label>
            <input type="file" class="form-control form-control-lg" name="pptx" accept=".pptx" required>
            <div class="form-text">Formats acceptés : .pptx uniquement (max 50MB)</div>
          </div>
          
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="start" class="form-label fw-bold">
                  <i class="bi bi-1-circle me-1"></i>Slide de début
                </label>
                <input type="number" class="form-control" name="start" value="31" min="1" required>
                <div class="form-text">Slide contenant les KPIs et synthèse</div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="end" class="form-label fw-bold">
                  <i class="bi bi-2-circle me-1"></i>Slide de fin
                </label>
                <input type="number" class="form-control" name="end" value="32" min="1" required>
                <div class="form-text">Slide contenant le tableau d'analyse</div>
              </div>
            </div>
          </div>
          
          <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <button type="submit" class="btn btn-primary btn-lg">
              <i class="bi bi-upload me-2"></i>Analyser le PowerPoint
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
